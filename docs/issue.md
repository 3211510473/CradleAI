剩余issue：按照优先级


1.朋友圈功能

转发；

点赞用户操作点赞/收藏/评论后，会重新加载页面，这是不必要的。

为界面创建一个收藏夹，用来存放所有用户收藏过的帖子，包含并同步帖子的状态。

朋友圈自己上传的图片可以打开

///角色认错人


2.摇篮功能

不需要刷新逻辑，所有页面上的状态更新立即显示到页面中

不再有孵化周期概念，所有的摇篮角色都是创建后立即生成的，因此也不再需要立即生成按钮。

摇篮生成的图片不仅要自动填充角色的backgroundimage，还要自动填充角色的avatar

滑动卡片的样式不好用，改成角色卡片的展示，重点在于让用户观赏角色卡的视觉效果。



在生成图片时，如果用户添加标签，不要自动去除掉那些原始的标签，而是在原始标签存在的基础上增加，除非用户自己删除掉这些原始标签

图库可点击查看原图

不再需要显示API页面



投喂功能重做，包括投喂的定时检查



3.关系系统

关系系统的问题：开启了的关系系统的角色，在关系图谱中新增关系的时候，查找不到其他的角色。

关系状态检视词，不要进行这样的约束：`这次发布可能的主题是：xxx`

关系图片的画布中，应该用角色头像代表角色，而不是色块

关系图谱中的关系类型用中文来表示

而是角色根据自己的设定去创作



///角色回复时认错人的问题

4.聊天功能

-兼容html格式


**I. 用户界面 (UI) 和用户体验 (UX) 增强:**

*   **按钮分组:** “重新生成”按钮和“赞/踩” (👍/👎) 按钮应该在 UI 中组合在一起。
*   **UI/UX 一致性:** 确保这些按钮拥有一致且统一的 UI/UX 设计。

**II. 重新生成按钮功能 (核心逻辑):**

*   **触发事件:** 当用户点击特定 AI 回复上的“重新生成”按钮 (我们称之为 AI 消息 *N*)。
*   **聊天记录删除:** 从 NodeST 存储的 `chathistory` 中移除以下条目:
    *   用户点击按钮的 AI 消息 *N*。
    *   在 AI 消息 *N* 之后的所有后续消息（包括 AI 和用户消息）。
*   **对话继续:** 重新启动“以同一角色继续对话”流程，使用紧接在已删除的 AI 消息 *N* 之前的用户消息。（用户消息 *N* - 1）。

**III. 角色请求体管理 (NodeST 集成):**

*   **NodeST 的角色存储:** NodeST 通过持久存储和更新角色请求体来存储每个角色的状态。
*   **请求体回滚:** 在发送重新生成请求之前，NodeST 中角色的请求体必须回滚到*发送用户消息 *N* - 1 时*的状态。 这对于保持角色一致性至关重要。
*   **请求传输:** 在请求体回滚之后，基于用户消息 *N* - 1 的新请求被发送到 AI 模型。

**IV. 示例场景:**

*   **原始聊天记录:**

    ```
    用户消息 1
    AI 消息 1
    用户消息 2
    AI 消息 2
    用户消息 3
    AI 消息 3
    ```

*   **重新生成操作:** 用户点击 AI 消息 2 上的“重新生成”按钮。

*   **结果操作:**
    1.  AI 消息 2、用户消息 3 和 AI 消息 3 从 `chathistory` 中删除。
    2.  NodeST 中角色的请求体回滚到发送用户消息 2 之前的状态。
    3.  使用用户消息 2 作为提示，发起“继续对话”请求。



```
用户消息1
AI消息1
用户消息2
AI消息2
用户消息2 ///用这条消息进行“同一角色继续对话”，并且回滚到这一时刻的请求体
```







-把图片url按钮整合到生成图片按钮中去，生成图片按钮允许用户输入url或本地上传图片

-兼容html格式


5.我的

页面完全参考flai的页面，图片使用default_background

只保留API设置和一个账号密码登录的功能


6.账号密码体系，安全体系
账号密码，激活码的体系和测试。
服务器的域名解析，去除IP的硬编码
生产环境的密钥问题
NAI图片隐写

7.UI fix

--bugfix

```

-UI修复重点在角色创建页面和摇篮页面

7.角色创建/详情页：

--提供预置preset条目，而不是现在这个默认条目配置

--头像放置在页面头图的左下角


8.角色卡页面

取消视图切换的按钮，只保留纵向排列的卡片视图。

取消角色创建按钮，因为在tab中已经有了创建

取消导出按钮





进程助手设置：

剧情推进助手是一种worldbook类条目的插入器。在开启它之后，每x次请求，会调用副ai来判断当前剧情推进状况

副ai使用和角色相同的preset



角色导入需要覆盖掉默认的preset条目