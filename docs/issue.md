剩余issue：按照优先级


1.朋友圈功能

转发；

点赞用户操作点赞/收藏/评论后，会重新加载页面，这是不必要的。

为界面创建一个收藏夹，用来存放所有用户收藏过的帖子，包含并同步帖子的状态。

朋友圈自己上传的图片可以打开

///角色认错人


2.摇篮系统
--所有模式创建的角色都进入cradle页面显示，都将被认为是摇篮角色



允许regenerate的图片，按照regenerate的配置再度生成

允许角色图库的图片保存到本地

允许调整提示词的顺序



阅读cradle页面图片再生成的相关代码，完成下列优化：

-重新生成功能允许调整提示词的顺序

-为角色图库的图片也增加重新生成的功能，允许这些regenerate得到的图片，能够按照regenerate时的提示词配置和风格配置再度生成，这样一来，如果用户再生成了一张喜欢的图片，他可以沿用同样的配置继续生成。

-角色图库允许将角色图库的图片保存到本地


- 生图服务需要激活码启动



3.关系系统


关系状态检视词，不要进行这样的约束：`这次发布可能的主题是：xxx`，而是角色根据自己的设定去创作


关系图片的画布中，应该用角色头像代表角色，而不是色块


而是角色根据自己的设定去创作



///角色回复时认错人的问题

4.聊天功能

-如果一位角色在聊天中，不影响另一位角色的聊天界面发送聊天按钮

-兼容html格式的需求

-向角色发送图片，以及角色连贯性的问题

-副ai状态栏和推进器

7.后端

测试账号轮询，以及准备账号

丢包处理

后端secretkey的安全性配置

NAI图片隐写术

将服务器地址替换成域名。


8.角色的创建：

-确认所有模式下创建的角色都在cradle页面显示

-上传的背景图裁剪框16：9

7.UI fix


```

-UI修复重点在角色创建页面和摇篮页面

7.角色创建/详情页：


--提供preset的导入

--角色导入需要覆盖掉默认的preset条目







进程助手设置：

剧情推进助手是一种worldbook类条目的插入器。在开启它之后，每x次请求，会调用副ai来判断当前剧情推进状况

副ai使用和角色相同的preset

-生图功能-激活码认证




1.为手动模式创建的角色，增加自动模式中通过tag生图的功能，因此现在我们可以统一两种模式的外观设置界面了

2.确保无论哪种模式生成的角色，都将被放入cradle页面，被认为是摇篮角色。
















**1.功能更新概述**

*   **目标:**  允许AI回复的消息中输入包含前端样式（如字体、字号、颜色等）的代码片段，并能正确地在消息条中渲染这些样式，从而实现富文本消息的效果。
*   **范围:**  支持主流的前端样式属性。

**2.详细功能需求**

*   **2.1 样式解析和渲染:**
    *   **支持的样式属性:**
        *   **字体:**  `font-family`, `font-size`, `font-weight`, `font-style`, `line-height`
        *   **颜色:**  `color`, `background-color`
        *   **文本:**  `text-align`, `text-decoration`, `text-transform`, `letter-spacing`, `word-spacing`
        *   **列表:**  `list-style-type`, `list-style-position`
        *   **边距和填充:**  `margin`, `padding`
        *   **其他:**  `display` (仅限 `inline` 和 `block`), `white-space` (仅限 `normal` 和 `pre-wrap`)
    *   **样式格式:**
        *   支持行内样式 (`<span style="...">`)
        *   支持简单的 CSS 类 (`<span class="my-class">`)  (可以限制为预定义的 CSS 类，提高安全性)
    *   **渲染机制:**
        *   使用安全的 HTML 解析器，防止 XSS 攻击。
        *   将解析后的样式安全地应用到消息条的 HTML 元素上。
*   **2.2 代码输入和转义:**
    *   **代码块标识:**  定义用于包裹代码片段的特殊语法，例如使用 ` ```css ... ``` ` 或 ` ```html ... ``` ` 来标识代码块。
    *   **代码转义:**  自动转义 HTML 实体（如 `<`、`>`、`&`、`"`）以防止解析错误和安全问题。
    *   **代码高亮:**  (可选)  对代码块进行语法高亮，提高可读性。（可以使用现成的库，例如 Prism.js 或 Highlight.js）
*   **2.3 用户体验:**
    *   **错误处理:**  当遇到无法解析的样式或代码时，直接发送原始的代码块，并给出友好的提示信息，而不是直接崩溃。
    *   **性能优化:**  确保样式解析和渲染过程不会影响聊天 App 的性能。


**5. 示例**

以下是一个包含代码片段的消息示例：

```
你好！这是一条 **测试** 消息，包含一些 *样式*：

```html
<span style="color: blue; font-size: 16px;">这是一段蓝色的文字</span>
<span class="highlight">这是使用 CSS 类的文字</span>
```

<style>
.highlight {
  background-color: yellow;
  font-weight: bold;
}
</style>

希望这个样式能正确显示！
```

预期效果：

*   "测试" 文字加粗
*   "样式" 文字倾斜
*   "这是一段蓝色的文字" 显示为蓝色，字号 16px
*   "这是使用 CSS 类的文字" 背景为黄色，加粗

