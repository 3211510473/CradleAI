## 功能文档：CircleInteraction - 角色关系图谱与社交体系

**目标：** 基于现有朋友圈互动功能，构建一个功能需求文档，需要描述角色的关系图谱与社交体系，增强互动深度和复杂性。

**背景知识：** 请参考 `circle-interaction-system` 文档和代码。

**核心问题：**

1.  **关系图谱构建 (横向):** 如何让角色在朋友圈互动中，动态构建和维护关系图谱？
2.  **阶层/团体构建 (纵向):** 除了横向关系，能否发展纵向的地位/尊卑类型的关系，让角色具有阶层/团体属性？
3.  **关系/阶层影响行为:** 如何让关系图谱/阶层体系影响角色的互动行为 (朋友圈内容、评论内容、互动频率等)？
4.  **圈子/群组呈现 (Explore 页面):** 如何在 Explore 页面以 "群组"/"圈子" 的形式呈现不同阶层/团体，并支持用户参与？

**详细设计：**

### 1. 关系图谱构建

*   **数据结构：**
    *   每个角色维护一个关系图谱数据结构 (例如：邻接表/矩阵)。
    *   关系强度：使用数值表示关系强度 (例如：-100 到 100)。
    *   关系类型：例如：朋友、竞争对手、崇拜者、厌恶者等。可以使用枚举类型或字符串常量表示。
*   **关系更新机制：**
    *   互动行为影响关系强度：
        *   频繁/积极的互动 (例如：点赞、评论) -> 增加关系强度。
        *   消极的互动 (例如：批评、争吵) -> 降低关系强度。
    *   内容分析：
        *   分析朋友圈内容和评论内容的情感色彩 (积极/消极)。
        *   分析内容中提及的其他角色，并根据情感色彩调整关系强度。

### 2. 阶层/团体构建

*   **阶层属性：**
    *   每个角色可以拥有一个阶层属性 (例如：领导者、普通成员、追随者)。
    *   阶层属性可以通过角色自身的设定或互动行为动态调整。
*   **团体属性：**
    *   每个角色可以属于一个或多个团体 (例如：学生会、运动队、秘密组织)。
    *   团体属性可以通过角色自身的设定或加入/退出行为来管理。
*   **阶层影响：**
    * 较高阶层角色可以对较低阶层角色发布指令或任务。
    * 阶层关系可以影响角色的互动倾向，比如下级更倾向于点赞上级的发言，或者对上级的指令表示服从。

### 3. 关系/阶层影响行为

*   **朋友圈内容生成：**
    *   角色关系图谱影响朋友圈内容的生成方向。 例如，如果角色与某个角色是竞争对手关系，可能会发布一些挑衅性的内容。
    *   角色阶层属性影响朋友圈内容的风格。 例如，领导者可能会发布一些鼓舞人心的内容。
*   **评论内容生成：**
    *   角色关系图谱影响评论内容的情感色彩和语气。 对朋友的评论会更友好，对竞争对手的评论会更尖锐。
    *   角色阶层属性影响评论的倾向。 较低阶层角色可能会对较高阶层角色的评论表示赞同。
*   **互动频率控制：**
    *   角色关系图谱影响互动频率。 角色更倾向于与关系密切的角色互动。
    *   角色阶层属性影响互动频率。 较低阶层角色可能更频繁地与较高阶层角色互动。

### 4. 圈子/群组呈现 (Explore 页面)

*   **群组/圈子载体：**
    *   在 Explore 页面创建 "群组"/"圈子" 板块，用于展示不同的阶层/团体。
    *   每个群组/圈子可以拥有自己的头像、名称、描述等信息。
*   **内容展示：**
    *   在群组/圈子页面展示该群组/圈子成员发布的朋友圈内容。
    *   用户可以点赞、评论这些内容，与其他成员互动。
*   **参与方式：**
    *   用户可以申请加入感兴趣的群组/圈子。
    *   加入条件可以根据群组/圈子的设定而有所不同 (例如：需要满足一定的等级要求、需要经过管理员审核)。
*   **聊天功能：**
    *   在群组/圈子页面提供聊天功能，方便成员之间进行实时交流。

**可验证性：**

*   每个模块都需要设计可验证的指标，例如：
    *   关系图谱构建的准确性 (例如：关系强度是否与实际互动行为一致)。
    *   阶层/团体划分的合理性 (例如：成员属性是否符合团体特征)。
    *   行为影响的有效性 (例如：朋友圈内容和评论内容是否受到关系图谱/阶层的影响)。

**可执行性：**

*   采用迭代开发的方式，逐步实现各个功能模块。
*   优先实现核心功能 (例如：关系图谱构建、朋友圈内容生成)，然后再逐步完善其他功能。
*   充分利用现有的代码和资源，减少开发成本。

**延展性：**

*   **引入更多互动类型：** 除了朋友圈，可以引入其他互动类型 (例如：私信、投票、活动)。
*   **引入更多关系类型：** 可以定义更多的关系类型，例如：师生关系、竞争关系、合作关系等。
*   **引入外部数据源：** 可以从外部数据源 (例如：社交媒体、知识图谱) 获取更多角色信息，丰富角色设定。

**这份功能文档旨在提供一个清晰、完整的设计思路，为后续的开发工作提供指导。**