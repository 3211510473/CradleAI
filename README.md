# AI 角色扮演应用

一个基于 React Native 和 Expo 的移动应用程序，用于创建和管理 AI 角色，实现角色对话和社交互动功能。

## 功能特色

### 1. 角色管理系统
- **创建角色**: 支持自定义多个角色的各种属性
  - 基本信息：姓名、种族、年龄、职业
  - 个性特征：性格、能力、对话风格
  - 外观设定：头像上传、背景图片设置
  - 世界观：角色背景故事和设定
- **角色编辑**: 随时修改角色设定和属性
- **数据导入导出**: 支持角色数据的备份与恢复

### 2. 智能对话系统
- **实时对话**: 基于 Dify API 的实时角色对话，未来将支持各大主流API
- **上下文记忆**: 持久化存储对话历史
- **多角色并发**: 支持同时与多个角色保持对话
- **角色记忆**: 支持长期记忆和短期记忆系统
- **自动回复**: 可选的角色主动对话功能
- **语音输入**: 支持语音等多模态输入（开发中）

### 3. 朋友圈功能
- **动态发布**: 角色自动生成朋友圈内容
- **社交互动**: 
  - 点赞功能
  - 评论系统
  - 内容转发
- **AI 互动**: 角色之间的自动互动与回复
- **多媒体支持**: 支持图片等媒体内容

### 4. 设置系统
- **全局设置**:
  - API 配置管理
  - 用户个人信息设置
- **角色设置**:
  - 永久记忆开关
  - 主动消息开关
  - 朋友圈互动开关
  - 对话背景设置

### 5. 摇篮系统
1. 角色培育
   - 可配置培育周期（1-65535天）
   - 实时进度显示和自动更新
   - 培育过程中断/恢复机制（开发中）
   - 数据定期同步（每24小时）

2. 用户交互数据收集
   - 消息频率统计
   - 消息评分记录
   - 朋友圈互动数据（点赞、收藏、评论）
   - 每小时自动更新统计数据

3. 新角色生成
   - 自动初始化对话
   - 摇篮角色特殊视觉效果
   - 角色诞生通知

4. 角色标识
   - 摇篮生成标记
   - 特殊视觉效果（光晕动画）
   - 可自定义动画参数（颜色、强度、速度）

5. 错误处理
   - 自动重试机制（最多3次）
   - 网络错误处理
   - 数据同步失败恢复

### 界面特性
1. 摇篮页面
   - 实时进度显示
   - 动态培育动画
   - 设置面板
   - 状态提示

2. 角色列表
   - 摇篮角色特殊标记
   - 发光效果展示
   - 角色状态显示

## 技术架构

### 核心技术栈
- React Native
- Expo
- TypeScript
- React Context (状态管理)

### 数据存储
- 使用 Expo FileSystem 进行本地存储
- 分类存储：
  - characters.json: 角色数据
  - conversations.json: 对话数据
  - messages.json: 消息记录
  - memos.json: 备忘录数据

### API 集成
- Dify API 对话系统
  - 角色对话
  - 朋友圈内容生成
  - 角色互动回复

### 摇篮系统实现
1. 数据存储
   - 本地持久化存储设置
   - 实时数据同步
   - 进度自动保存

2. 动画系统
   - Reanimated2 动画
   - 自定义发光效果
   - 性能优化

3. 状态管理
   - Context API
   - 自动更新机制
   - 错误处理和恢复

## 项目结构
```
/f:/my-app/
├── app/
│   ├── (tabs)/
│   │   ├── index.tsx      # 主聊天界面
│   │   ├── explore.tsx    # 朋友圈页面
│   │   ├── cradle.tsx     # 角色培育页面
│   │   └── Character.tsx  # 角色管理页面
│   └── pages/
│       ├── create_char.tsx    # 创建角色页面
│       └── character-detail   # 角色详情页面
├── components/
│   ├── ChatDialog.tsx     # 对话界面组件
│   ├── ChatInput.tsx      # 输入组件
│   ├── SettingsSidebar.tsx# 设置侧边栏
│   └── ...
├── constants/
│   ├── types.ts           # 类型定义
│   ├── CharactersContext.tsx  # 角色上下文
│   └── ...
└── ...
```

## 未来规划
1. 添加语音交互功能
2. 优化角色培育系统
3. 增加角色关系网络
4. 支持更多类型的媒体内容
5. 添加数据同步和云备份功能

## 安装和运行

```bash
# 安装依赖
npm install

# 启动开发服务器
npx expo start

# 构建应用
eas build
```

## 环境要求
- Node.js 14+
- Expo CLI
- Android SDK / Xcode
- Dify API 密钥

## 配置说明

1. 在应用中配置必要的 API 密钥：
   - Character API Key
   - Memory API Key
   - X-API-Key

2. 配置服务器 URL：
   - 在设置中填入 Dify 服务器地址

## 注意事项

- 确保网络连接稳定
- 正确配置所有 API 密钥
- 定期备份角色数据
- 注意管理存储空间

## 许可证

[MIT License](LICENSE)
