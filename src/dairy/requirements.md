**目标：** 构建基于多维度反思和行动的日记机制，增强角色人设一致性，提升用户体验。

**核心概念：**

*   **日记 = 日记文本 + 行动决策**
*   **触发时机：** 定时 (可配置：每天、每隔 N 小时)
*   **综合性反思：** AI 驱动，生成日记文本

**功能模块：**

1.  **综合性反思 (AI 驱动):**
    *   **基本目标：** 用户自定义 (例如："思考如何更好地与用户建立情感连接"，"反思最近的行动是否符合角色价值观"，"分析当前剧情发展趋势并预测未来走向")。
    *   **反思维度 (LLM 参考 - 权重可配置):**
        *   聊天上下文 (利用`storage-adapter`提取`当天`的聊天记录。`没有聊天记录也传达了一种信息`，说明用户没有找角色聊天。)。
        *   角色设定 JSON 数据 (Character 对象的 `jsondata` 参数 - 权重可配置)。
        *   可用世界信息 (预留占位，计划先引入日期、天气等简单信息，逐步扩展)。
        *   应如何调整自己的对话策略 (文字)。
    *   **LLM 输出：**
        *   `XX` 字 (用户可配置) 角色口吻日记文本（参照上述反思维度，并遵循设定的权重）。
        *   *关键 Prompt 设计要点：清晰引导 LLM 完成日记文本的生成，确保内容符合角色设定，并为后续的行动决策提供依据。*
    *   **LLM 选择：**
        *   根据`api-settings`页面用户的api设置，来访问对应的适配器的`ApiServiceProvider.generateContent`方法，并取得LLM的输出内容。            

2.  **用户设定项 (日记本页面 - 每个角色独立配置):**
    *   综合反思基本目标 (文本输入框)。
    *   日记字数 (数值选择器)。
    *   反思维度权重 (滑块/数值输入框，控制每个维度的重要性)。
    *   最低置信度阈值 (滑块/数值输入框)。
    *   定时触发间隔 (下拉菜单 - 例如：每天、每隔 N 小时)。
    *   *手动 Override 行动决策 (开关 - 强制发送/不发送消息)。*

3.  **前端呈现：**
    *   **入口：** Character.tsx 页面右上角 - 增加"日记本" 按钮。
    *   **日记本页面：** 按角色展示日记，并提供历史日记浏览功能 (例如：按日期排序)。
    *   **用户设置：** 每个角色的日记本页面，允许用户进行 **用户设定项** 的配置。
    *   **界面风格：** 模拟真实日记本样式。
    *   *增加中文错误信息显示和日志查看功能，方便调试和排错。*
